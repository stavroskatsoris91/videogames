<div class="row" dates-selector date-type="vm.dateType" to-date="vm.toDate" from-date="vm.fromDate" group-by="vm.groupBy" remove-amazon="true" callback="vm.reload()">
</div>
<div class="row">
  <div class="col-lg-12 col-md-12 col-sm-12">
      <div class="card">
        <div class="card-heading">
          <div class="row">
            <div class="col-xs-10">
              <h2>SelfHelp Graph</h2>
              <small>Total orders: {{vm.total_orders}}</small>
            </div>
        </div>
      </div>
        <div class="panel-body text-center">
          <div ng-if="vm.countArray" ui-jp="plot" ui-options="
              [
                {
                  data: {{vm.countArray}},
                  points: { show: true, radius: 0},
                  splines: { show: true, tension: 0.45, lineWidth: 1, fill: 0.2 } },
              ], 
              {
                colors: ['{{app.color.info}}','{{app.color.dark}}','{{app.color.success}}','{{app.color.warning}}'],
                series: { shadowSize: 3 },
                xaxis: { show: true, font: { color: '#ccc' }, position: 'bottom',mode : 'time' },
                yaxis:{ show: true, font: { color: '#ccc' }},
                grid: { hoverable: true, clickable: true, borderWidth: 0, color: '#ccc' },
                tooltip: true,
                tooltipOpts: { content: '%x:%y.0',  defaultTheme: false, shifts: { x: 0, y: -40 } }
              }
            " style="height:236px" ui-refresh="vm.countArray">
          </div>
        </div>
      </div>
    </div>
</div>
<div class="row" ng-if="vm.searchList.total_pages > 0">
  <div class="col-lg-12">
    <div class="panel">
      <div class="panel-body text-center">
        <div class="pull-left col-xs-12 col-md-5">
          <md-button class="md-raised md-primary btn-fw m-b-sm pull-left" ng-if="vm.page > 0" ng-click="vm.changePage(0)">First</md-button>
          <md-button class="md-raised md-primary btn-fw m-b-sm pull-left" ng-if="vm.page > 0" ng-click="vm.changePage(vm.page-1)">Prev</md-button>
        </div>
        <div class="col-xs-12 col-md-2">
          <form ng-submit="vm.changePage(vm.text-1)">
            page <input type="text" ng-model="vm.text" style="width:40px">of {{vm.searchList.total_pages}}
          </form>  
        </div>
        <div class="pull-right col-xs-12 col-md-5">
          <md-button class="md-raised md-primary btn-fw m-b-sm  pull-right" ng-if="vm.page != vm.searchList.total_pages - 1" ng-click="vm.changePage(vm.searchList.total_pages-1)">Last</md-button> 
          <md-button class="md-raised md-primary btn-fw m-b-sm  pull-right" ng-if="vm.page != vm.searchList.total_pages - 1" ng-click="vm.changePage(vm.page+1)">Next</md-button> 
        </div>
       </div>
    </div>
  </div>
</div>
<div class="row" ng-if="vm.loading">
  <div class="col-sm-6 col-md-offset-3">
    <div class="panel panel-card">
      <div class="panel-body text-center">
        <p>Loading</p>
        <md-progress-linear md-mode="indeterminate" class="m-b"></md-progress-linear>
      </div>
    </div>
  </div>
</div>
<!-- No Result -->
<div class="row" ng-if="vm.searchList.total_pages == 0 && !vm.loading">
  <div class="col-sm-6 col-md-offset-3">
    <div class="panel panel-card">
      <div class="panel-body text-center">
        <p>No order found</p>
      </div>
    </div>
  </div>
</div>
<!-- Result -->
<div class="row">
  <div class="col-md-12">
    <div class="md-list md-whiteframe-z0 bg-white m-b" ng-if="vm.searchList.total_pages > 0&&!vm.loading">
      <div class="md-list-item btn-default" ng-repeat="result in vm.searchList.orders">
        <a  ui-sref="users.order({orderId: result.id})">
          <div class="row">
            <div class="col-sm-2 col-md-2 col-lg-1">
              <span ng-if="vm.hasMore(result.cards)" class="badge badge-lg" style="position : absolute">+{{vm.hasMore(result.cards)}}</span>
              <img ng-src="{{result.cards[0].image.medium}}" class="w-full">
            </div>
            <div class="col-sm-10 col-md-10 col-lg-11">
              <div class="row">
                <div class="h4">{{result.cards[0].format}} <strong ng-class="vm.changeColor(result.status,'text')">{{result.status}}</strong></div>
                <div class="col-sm-4">
                  <div>
                    <small class="font-thin">Price: </small><small>{{result.costs.final_cost| currency : '£'}}</small>
                    <i ng-if="result.payment_method_type==='PAYPAL'" class="fa text-primary i-20 fa-cc-paypal"></i>
                    <i ng-if="result.payment_method_type!=='PAYPAL'" class="fa text-primary i-20 fa-cc-stripe"></i>
                  </div>
                  <div>
                    <small class="font-thin">Discount: </small><small ng-if="result.costs.discount_amount">{{result.costs.discount_amount | currency : '£'}}</small><small ng-if="!result.costs.discount_amount">- </small>
                    <small ng-if="result.costs.credits_used"><small class="font-thin">Credits Used: </small>{{result.costs.credits_used}}</small>
                    <small ng-if="result.costs.discount_campaign_name"><small class="font-thin">Coupon Used: </small>{{result.costs.discount_campaign_name}}</small>
                  </div>
                  <div>
                    <small class="font-thin">Date: </small><small>{{result.created | date : 'd/M/yy HH:mm:ss'}}</small>
                    <!--<small class="font-thin">Last Update: </small><small>{{result.last_updated |  | date : mediumDate}}}}</small>-->
                  </div>
                  <!-- <div>
                    <md-button class="md-raised md-warn" ng-if="false" ng-click="vm.moderate()">Unmoderated</md-button>
                  </div> -->
                </div>
                <div class="col-sm-4">
                  <div>
                    <strong>From</strong>
                    <div ng-repeat="report in vm.buyerName(result.buyer_id)">
                        <small ng-class="$index!==0?'font-thin':''">{{report.split(':')[0]}}</small>
                        <small>{{report.split(':')[1]}}</small>
                    </div>
                  </div>
                </div>
                <div class="col-sm-4">
                  <div>
                    <strong>To</strong><br>
                    <small>{{result.delivery_address.recipient}}</small>
                    <small class="font-thin"> {{result.recipient_type}}</small>
                  </div>
                  <div>
                    <small>{{result.delivery_address.city}},{{result.delivery_address.country}}</small>
                  </div>
                  <div>
                    <small class="font-thin">Dispatch: </small><small>{{result.order_delivery.dispatch_type}}</small>
                    <small class="font-thin" ng-if="result.order_delivery.requested_arrival_date">Requested Date: </small><small>{{result.order_delivery.requested_arrival_date| date : "d/M/yy"}}</small>
                  </div>
                  <div>
                    <small class="font-thin">Arrival Date: </small><small>{{result.order_delivery.estimated_earliest_arrival_date | date : "d/M/yy"}}</small>
                  </div>
                  <div>
                    <small class="font-thin" ng-if="result.order_delivery.requested_arrival_date">Requested Date: </small><small>{{result.order_delivery.requested_arrival_date | date : "d/M/yy"}}</small>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </a>
      </div>
    </div>
  </div>
</div>
<div class="row" ng-if="vm.searchList.total_pages > 1 &&!vm.loading">
  <div class="col-lg-12">
    <div class="panel">
      <div class="panel-body text-center">
        <div class="pull-left col-xs-12 col-md-5">
          <md-button class="md-raised md-primary btn-fw m-b-sm pull-left" ng-if="vm.page > 0" ng-click="vm.changePage(0)">First</md-button>
          <md-button class="md-raised md-primary btn-fw m-b-sm pull-left" ng-if="vm.page > 0" ng-click="vm.changePage(vm.page-1)">Prev</md-button>
        </div>
        <div class="col-xs-12 col-md-2">
          <form ng-submit="vm.changePage(vm.text-1)">
            page <input type="text" ng-model="vm.text" style="width:40px">of {{vm.searchList.total_pages}}
          </form>  
        </div>
        <div class="pull-right col-xs-12 col-md-5">
          <md-button class="md-raised md-primary btn-fw m-b-sm  pull-right" ng-if="vm.page != vm.searchList.total_pages - 1" ng-click="vm.changePage(vm.searchList.total_pages-1)">Last</md-button> 
          <md-button class="md-raised md-primary btn-fw m-b-sm  pull-right" ng-if="vm.page != vm.searchList.total_pages - 1" ng-click="vm.changePage(vm.page+1)">Next</md-button> 
        </div>
       </div>
    </div>
  </div>
</div>